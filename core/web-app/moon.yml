language: 'typescript'
type: 'application'
owners:
  defaultOwner: '@wave-autoscale-team'

env:
  NEXT_PUBLIC_API_BASE_URL: 'http://localhost:3024'

tasks:
  install:
    command: 'npm install'
    inputs:
      - './package.json'
      - './package-lock.json'
      - './node_modules/**/*'
  lint:
    command: 'next lint'
    inputs:
      - '@globs(sources)'
  audit:
    command: 'npm audit'
    inputs:
      - '@globs(sources)'
  test:
    # TODO: Add test command
    command: 'echo wep-app'
    deps:
      - 'install'
      - 'lint'
  run:
    command: 'next dev --port 3025'
    inputs:
      - '@globs(sources)'
      - 'tsconfig.json'
      - 'next.config.js'
      - '.env.local'
      - 'package.json'
    deps:
      - 'test'
  build:
    command: 'next build'
    inputs:
      - '@globs(sources)'
      - 'tsconfig.json'
      - 'next.config.js'
    outputs:
      - '.next/standalone/*'
  start-standalone:
    command: 'node .next/standalone/server.js'
    inputs:
      - '@globs(sources)'
      - 'tsconfig.json'
