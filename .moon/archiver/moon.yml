language: "bash"

tasks:
  # TODO: Add back in when we have a fix for
  audit:
    command: "cargo audit --ignore RUSTSEC-2022-0090 --ignore RUSTSEC-2020-0071"
    options:
      runFromWorkspaceRoot: true
  lint:
    command: "echo archiver"
  test:
    command: "echo archiver"
  clean-cargo-cache:
    command: "cargo cache --autosclean"
  archive-aarch64-apple-darwin:
    command: "./archive-script.sh"
    platform: "system"
    inputs:
      - "**/*"
    deps:
      - "wave-metrics:build-aarch64-apple-darwin"
      - "api-server:build-aarch64-apple-darwin"
      - "controller:build-aarch64-apple-darwin"
      - "cli:build-aarch64-apple-darwin"
      - "web-app:build"
    env:
      PLATFORM: "aarch64-apple-darwin"
